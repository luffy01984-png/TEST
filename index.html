<button class="accordion-btn">6. Contact <span class="arrow">‚ñ∂</span></button>
<div class="accordion-content">
  <p>
    Pour toute demande, vous pouvez contacter l'√©quipe du CSE par e-mail 
    <a href="mailto:cserenaulttrucks@gmail.com" style="color: red; font-weight: bold;">
      cserenaulttrucks@gmail.com
    </a>
  </p>
</div>
</section>

<!-- MINI JEU DOODLE JUMP -->
<section class="bg-gradient-to-b from-gray-100 to-gray-200 py-8 px-4 mt-8">
  <div class="max-w-md mx-auto">
    <h2 class="text-2xl font-bold text-center mb-4 text-red-600">üéÆ Mini-Jeu : Jump CSE !</h2>
    
    <!-- Contr√¥les du jeu -->
    <div class="bg-white rounded-xl p-4 mb-4 shadow-lg">
      <div class="flex justify-between items-center mb-3">
        <div class="text-sm font-bold">Score: <span id="gameScore" class="text-red-600">0</span></div>
        <div class="text-sm font-bold">Record: <span id="gameHighScore" class="text-red-600">0</span></div>
      </div>
      
      <!-- S√©lecteur de personnage -->
      <div class="mb-3">
        <label class="text-sm font-semibold block mb-2">Choisis ton personnage:</label>
        <div class="flex gap-2 justify-center">
          <button onclick="changeCharacter('mario')" class="character-btn p-2 bg-gray-100 rounded-lg hover:bg-red-100 transition ring-4 ring-red-500">
            <img src="https://raw.githubusercontent.com/luffy01984-png/Renault-trucks-CE/main/assets/mario.jpg" alt="Mario" class="w-10 h-10 object-cover rounded">
          </button>
          <button onclick="changeCharacter('üöõ')" class="character-btn text-3xl p-2 bg-gray-100 rounded-lg hover:bg-red-100 transition">üöõ</button>
          <button onclick="changeCharacter('üèÉ')" class="character-btn text-3xl p-2 bg-gray-100 rounded-lg hover:bg-red-100 transition">üèÉ</button>
          <button onclick="changeCharacter('üê±')" class="character-btn text-3xl p-2 bg-gray-100 rounded-lg hover:bg-red-100 transition">üê±</button>
          <button onclick="changeCharacter('ü¶ä')" class="character-btn text-3xl p-2 bg-gray-100 rounded-lg hover:bg-red-100 transition">ü¶ä</button>
          <button onclick="changeCharacter('üöÄ')" class="character-btn text-3xl p-2 bg-gray-100 rounded-lg hover:bg-red-100 transition">üöÄ</button>
        </div>
      </div>
      
      <button onclick="startGame()" id="startBtn" class="w-full bg-red-600 text-white font-bold py-3 rounded-lg hover:bg-red-700 transition">
        D√©marrer
      </button>
    </div>
    
    <!-- Canvas du jeu -->
    <div class="relative bg-gradient-to-b from-blue-300 to-blue-100 rounded-xl shadow-2xl overflow-hidden">
      <canvas id="gameCanvas" width="350" height="500" class="w-full block"></canvas>
      <div id="gameOverScreen" class="absolute inset-0 bg-black bg-opacity-80 flex flex-col items-center justify-center hidden">
        <div class="text-white text-center">
          <h3 class="text-3xl font-bold mb-2">Game Over!</h3>
          <p class="text-xl mb-4">Score: <span id="finalScore" class="text-yellow-300">0</span></p>
          <button onclick="startGame()" class="bg-red-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-700 transition">
            Rejouer
          </button>
        </div>
      </div>
    </div>
    
    <!-- Instructions -->
    <div class="bg-white rounded-xl p-4 mt-4 shadow-lg">
      <p class="text-sm text-center text-gray-600">
        <strong>Comment jouer:</strong> Penche ton t√©l√©phone √† gauche/droite ou utilise les fl√®ches du clavier pour d√©placer le personnage. Saute sur les plateformes pour monter le plus haut possible !
      </p>
    </div>
  </div>
</section>

<script>
// ===== DOODLE JUMP GAME =====
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const gameOverScreen = document.getElementById('gameOverScreen');
const scoreDisplay = document.getElementById('gameScore');
const highScoreDisplay = document.getElementById('gameHighScore');
const finalScoreDisplay = document.getElementById('finalScore');
const startBtn = document.getElementById('startBtn');

let gameRunning = false;
let score = 0;
let highScore = localStorage.getItem('jumpHighScore') || 0;
highScoreDisplay.textContent = highScore;

// Charger l'image du personnage Mario
const playerImg = new Image();
playerImg.src = 'https://raw.githubusercontent.com/luffy01984-png/Renault-trucks-CE/main/assets/mario.jpg';
playerImg.crossOrigin = "anonymous"; // Pour √©viter les probl√®mes CORS

// Personnage
let player = {
  x: canvas.width / 2 - 30,
  y: canvas.height - 150,
  width: 60,
  height: 60,
  velocityY: 0,
  velocityX: 0,
  gravity: 0.4,
  jumpPower: -12,
  character: 'üöõ',
  useImage: true
};

// Plateformes
let platforms = [];
const platformWidth = 70;
const platformHeight = 12;
let cameraY = 0;

// Acc√©l√©rom√®tre
let tiltX = 0;

function initGame() {
  platforms = [];
  score = 0;
  cameraY = 0;
  player.x = canvas.width / 2 - player.width / 2;
  player.y = canvas.height - 150;
  player.velocityY = 0;
  player.velocityX = 0;
  
  // Plateforme de d√©part juste sous le joueur
  platforms.push({
    x: canvas.width / 2 - platformWidth / 2,
    y: canvas.height - 100,
    width: platformWidth,
    height: platformHeight
  });
  
  // Cr√©er plateformes initiales FACILES (plus proches)
  for(let i = 1; i < 10; i++) {
    platforms.push({
      x: Math.random() * (canvas.width - platformWidth),
      y: canvas.height - 100 - (i * 50), // Espacement r√©duit de 70 √† 50
      width: platformWidth,
      height: platformHeight
    });
  }
}

function startGame() {
  if(gameRunning) return;
  gameRunning = true;
  gameOverScreen.classList.add('hidden');
  startBtn.textContent = 'En cours...';
  startBtn.disabled = true;
  initGame();
  gameLoop();
  
  // D√©marrer l'acc√©l√©rom√®tre sur mobile
  if(typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
    DeviceOrientationEvent.requestPermission()
      .then(response => {
        if(response === 'granted') {
          window.addEventListener('deviceorientation', handleTilt);
        }
      });
  } else {
    window.addEventListener('deviceorientation', handleTilt);
  }
}

function handleTilt(event) {
  if(!gameRunning) return;
  tiltX = event.gamma || 0; // Inclinaison gauche/droite (-90 √† 90)
  player.velocityX = tiltX / 10; // Sensibilit√©
}

// Contr√¥les clavier
const keys = {};
window.addEventListener('keydown', (e) => { keys[e.key] = true; });
window.addEventListener('keyup', (e) => { keys[e.key] = false; });

function updatePlayer() {
  // Contr√¥les clavier
  if(keys['ArrowLeft']) player.velocityX = -5;
  else if(keys['ArrowRight']) player.velocityX = 5;
  else if(Math.abs(tiltX) < 5) player.velocityX *= 0.8; // Friction
  
  player.x += player.velocityX;
  player.velocityY += player.gravity;
  player.y += player.velocityY;
  
  // Wraparound horizontal
  if(player.x > canvas.width) player.x = 0;
  if(player.x < -player.width) player.x = canvas.width;
  
  // Collision avec plateformes (seulement en descendant)
  if(player.velocityY > 0) {
    platforms.forEach(platform => {
      if(
        player.x < platform.x + platform.width &&
        player.x + player.width > platform.x &&
        player.y + player.height > platform.y &&
        player.y + player.height < platform.y + platform.height + 5
      ) {
        player.velocityY = player.jumpPower;
      }
    });
  }
  
  // D√©placer la cam√©ra vers le haut quand le joueur monte
  if(player.y < canvas.height / 2) {
    const diff = canvas.height / 2 - player.y;
    player.y = canvas.height / 2;
    cameraY += diff;
    score += Math.floor(diff / 10);
    scoreDisplay.textContent = Math.floor(score);
    
    // G√©n√©rer nouvelles plateformes
    platforms.forEach(platform => {
      platform.y += diff;
    });
    
    while(platforms[platforms.length - 1].y > 0) {
      platforms.push({
        x: Math.random() * (canvas.width - platformWidth),
        y: platforms[platforms.length - 1].y - 50 - Math.random() * 20, // Plus rapproch√©es
        width: platformWidth,
        height: platformHeight
      });
    }
    
    // Supprimer plateformes hors √©cran
    platforms = platforms.filter(p => p.y < canvas.height + 50);
  }
  
  // Game Over
  if(player.y > canvas.height) {
    endGame();
  }
}

function drawPlayer() {
  if(player.useImage && playerImg.complete) {
    // Dessiner l'image Mario avec un fond blanc pour voir si elle charge
    ctx.fillStyle = 'white';
    ctx.fillRect(player.x, player.y, player.width, player.height);
    ctx.drawImage(playerImg, player.x, player.y, player.width, player.height);
    
    // Bordure pour debug
    ctx.strokeStyle = 'red';
    ctx.lineWidth = 2;
    ctx.strokeRect(player.x, player.y, player.width, player.height);
  } else {
    // Afficher l'emoji en attendant le chargement ou si emoji s√©lectionn√©
    ctx.font = '50px Arial';
    ctx.fillText(player.character, player.x, player.y + 45);
  }
}

function drawPlatforms() {
  ctx.fillStyle = '#22c55e';
  platforms.forEach(platform => {
    ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
    ctx.strokeStyle = '#16a34a';
    ctx.lineWidth = 2;
    ctx.strokeRect(platform.x, platform.y, platform.width, platform.height);
  });
}

function gameLoop() {
  if(!gameRunning) return;
  
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  // Fond avec nuages
  ctx.fillStyle = '#bae6fd';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  
  drawPlatforms();
  updatePlayer();
  drawPlayer();
  
  requestAnimationFrame(gameLoop);
}

function endGame() {
  gameRunning = false;
  gameOverScreen.classList.remove('hidden');
  finalScoreDisplay.textContent = Math.floor(score);
  startBtn.textContent = 'D√©marrer';
  startBtn.disabled = false;
  
  if(score > highScore) {
    highScore = Math.floor(score);
    localStorage.setItem('jumpHighScore', highScore);
    highScoreDisplay.textContent = highScore;
  }
  
  window.removeEventListener('deviceorientation', handleTilt);
  tiltX = 0;
}

function changeCharacter(char) {
  if(char === 'mario') {
    player.useImage = true;
    player.width = 60;
    player.height = 60;
  } else {
    player.useImage = false;
    player.character = char;
    player.width = 50;
    player.height = 50;
  }
  document.querySelectorAll('.character-btn').forEach(btn => {
    btn.classList.remove('ring-4', 'ring-red-500');
  });
  event.target.classList.add('ring-4', 'ring-red-500');
}

// Initialiser le jeu au chargement
initGame();
ctx.fillStyle = '#64748b';
ctx.font = 'bold 20px Arial';
ctx.textAlign = 'center';
ctx.fillText('Appuie sur D√©marrer!', canvas.width/2, canvas.height/2);
</script>
